<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>OmniTools AI | Unified Supermodel Suite</title>
<script src="https://unpkg.com/lucide@latest"></script>
<style>
@import url('https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;600;800&display=swap');
:root {
    --bg:#050505; --sidebar:#0a0a0c; --accent:#06b6d4; --gold:#f59e0b;
    --card:#111113; --border:rgba(255,255,255,0.08); --text-dim:#88888e;
}
*{box-sizing:border-box;font-family:'Plus Jakarta Sans',sans-serif;transition:0.2s cubic-bezier(0.4,0,0.2,1);}
body{margin:0;background:var(--bg);color:white;display:flex;height:100vh;overflow:hidden;}
#authScreen{position:fixed;inset:0;background:var(--bg);z-index:9999;display:flex;align-items:center;justify-content:center;}
.auth-card{background:var(--card);padding:50px;border-radius:30px;width:450px;border:1px solid var(--border);text-align:center;box-shadow:0 0 100px rgba(6,182,212,0.1);}
.logo-text{font-size:2rem;font-weight:800;background:linear-gradient(to right,var(--accent),var(--gold));-webkit-background-clip:text;-webkit-text-fill-color:transparent;letter-spacing:-1px;}
.sidebar{width:340px;background:var(--sidebar);padding:25px;display:flex;flex-direction:column;border-right:1px solid var(--border);}
.nav-section{margin-top:30px;}
.nav-item{display:flex;align-items:center;gap:12px;padding:14px;border-radius:12px;cursor:pointer;color:var(--text-dim);margin-bottom:5px;font-size:0.9rem;font-weight:600;}
.nav-item:hover,.nav-item.active{background:rgba(255,255,255,0.05);color:var(--accent);}
.nav-item i{width:18px;}
.vault-container{flex:1;overflow-y:auto;margin-top:20px;}
.key-card{padding:15px;border-radius:16px;background:#161618;border:1px solid var(--border);margin-bottom:10px;cursor:pointer;position:relative;}
.key-card.active{border-color:var(--accent);background:rgba(6,182,212,0.05);}
.main{flex:1;display:flex;flex-direction:column;position:relative;}
header{padding:20px 40px;border-bottom:1px solid var(--border);display:flex;justify-content:space-between;align-items:center;background:rgba(5,5,5,0.8);backdrop-filter:blur(10px);}
.chat-area{flex:1;overflow-y:auto;padding:40px 15%;display:flex;flex-direction:column;gap:30px;}
.msg{max-width:85%;line-height:1.7;font-size:1rem;display:flex;gap:15px;}
.msg.user{align-self:flex-end;flex-direction:row-reverse;}
.bubble{padding:16px 24px;border-radius:20px;background:var(--card);border:1px solid var(--border);position:relative;}
.user .bubble{background:var(--accent);color:black;font-weight:500;border:none;}
.voice-btn{position:absolute;bottom:-25px;right:0;background:none;border:none;color:var(--text-dim);cursor:pointer;font-size:0.7rem;display:flex;align-items:center;gap:4px;}
.input-wrapper{padding:20px 15% 40px;position:relative;}
.command-center{background:#161618;border:1px solid var(--border);border-radius:28px;padding:10px 20px;display:flex;flex-direction:column;gap:10px;box-shadow:0 20px 40px rgba(0,0,0,0.5);}
.toolbar{display:flex;gap:15px;padding-bottom:8px;border-bottom:1px solid rgba(255,255,255,0.05);}
.tool-btn{background:none;border:none;color:var(--text-dim);cursor:pointer;display:flex;align-items:center;gap:6px;font-size:0.75rem;font-weight:600;padding:5px 10px;border-radius:8px;}
.tool-btn:hover{background:rgba(255,255,255,0.05);color:white;}
.tool-btn.highlight{color:var(--gold);}
.input-row{display:flex;align-items:center;gap:15px;}
textarea{flex:1;background:transparent;border:none;color:white;outline:none;resize:none;font-size:1rem;padding:10px 0;}
.send-btn{background:var(--accent);color:black;border:none;width:45px;height:45px;border-radius:50%;cursor:pointer;display:flex;align-items:center;justify-content:center;}
.modal{display:none;position:fixed;inset:0;background:rgba(0,0,0,0.9);z-index:10000;align-items:center;justify-content:center;backdrop-filter:blur(10px);}
.modal-content{background:var(--sidebar);width:550px;padding:40px;border-radius:32px;border:1px solid var(--border);}
input,select{width:100%;padding:14px;border-radius:14px;background:#000;border:1px solid var(--border);color:white;margin-top:10px;}
</style>
</head>
<body>

<div id="authScreen">
<div class="auth-card">
<div class="logo-text">OmniTools AI</div>
<p style="color:var(--text-dim);margin:15px 0 30px;">The Apex Intelligence OS</p>
<input type="email" id="authEmail" placeholder="Enter workspace email">
<input type="password" id="authPass" placeholder="Secure Password">
<button class="primary-btn" style="width:100%; padding:15px; border-radius:15px; background:var(--accent); border:none; font-weight:800; margin-top:20px; cursor:pointer;" id="authBtn">Initialize Session</button>
</div>
</div>

<div class="sidebar">
<div class="logo-text" style="font-size:1.5rem;">OmniTools AI</div>
<div class="nav-section">
<div class="nav-item active"><i data-lucide="message-square"></i> Multi-Chat</div>
<div class="nav-item"><i data-lucide="image"></i> Studio (Photo AI)</div>
<div class="nav-item"><i data-lucide="file-text"></i> Doc Analyzer</div>
<div class="nav-item"><i data-lucide="share-2"></i> Social Creator</div>
<div class="nav-item" onclick="openKeyModal()"><i data-lucide="key"></i> API Vault</div>
</div>
<div class="vault-container" id="vaultList"></div>
<div style="margin-top:auto;padding-top:20px;border-top:1px solid var(--border);">
<div id="userName" style="font-weight:700;color:var(--gold);">GUEST OPERATOR</div>
<button onclick="location.reload()" style="background:none;border:none;color:var(--text-dim);font-size:0.8rem;cursor:pointer;margin-top:10px;">Logout</button>
</div>
</div>

<div class="main">
<header>
<div id="activeInfo" style="display:flex;flex-direction:column;">
<span style="font-size:0.7rem;color:var(--text-dim);text-transform:uppercase;">Active Intelligence</span>
<span id="activeModelName" style="font-weight:800;color:var(--accent);">No Model Selected</span>
</div>
<div style="display:flex;gap:20px;">
<i data-lucide="mic" style="cursor:pointer;color:var(--text-dim)" id="micIcon"></i>
<i data-lucide="bell" style="color:var(--text-dim)"></i>
</div>
</header>

<div class="chat-area" id="chat">
<div class="msg">
<div class="bubble">
Welcome to <strong>OmniTools AI</strong>!<br><br>
- Upload <strong>Photos</strong> to generate AI avatars.<br>
- Drop <strong>PDFs/Excel</strong> to extract info.<br>
- Generate <strong>Social Media Posts</strong>.<br>
- Create <strong>Code & Games</strong> instantly.<br>
- Choose the best model for each task: GPT-4.1, Gemini 2.0, LLaMA 3.3.<br>
Select your Gateway key from the sidebar to start.
</div>
</div>
</div>

<div class="input-wrapper">
<div class="command-center">
<div class="toolbar">
<label class="tool-btn highlight">
<i data-lucide="image" size="14"></i> Photo AI
<input type="file" hidden accept="image/*" onchange="handleImageUpload(event)">
</label>
<label class="tool-btn">
<i data-lucide="file-spreadsheet" size="14"></i> Data/PDF
<input type="file" hidden accept=".pdf,.xlsx,.csv" onchange="handleFileUpload(event)">
</label>
<button class="tool-btn" onclick="generateDevCode()"><i data-lucide="code" size="14"></i> Dev Mode</button>
<button class="tool-btn" onclick="generateSocialPost()"><i data-lucide="instagram" size="14"></i> Social Post</button>
</div>
<div class="input-row">
<textarea id="msg" placeholder="Command OmniTools AI..." rows="1" oninput="autoSize(this)"></textarea>
<button class="send-btn" onclick="sendMessage()"><i data-lucide="arrow-up" size="20"></i></button>
</div>
</div>
</div>
</div>

<div id="keyModal" class="modal">
<div class="modal-content">
<h2 style="margin:0;color:var(--accent);">Gateway Configuration</h2>
<input type="text" id="keyNick" placeholder="Gateway Nickname">
<input type="password" id="keyVal" placeholder="OpenRouter API Key">
<select id="modelSelect">
<option value="openai/gpt-4.1:latest">GPT-4.1</option>
<option value="openai/gpt-4-turbo:latest">GPT-4 Turbo</option>
<option value="google/gemini-2.0-flash-exp:latest">Gemini 2.0 Flash</option>
<option value="google/gemini-2.0-multimodal:latest">Gemini 2.0 Multimodal</option>
<option value="meta-llama/llama-3.3-70b-instruct:latest">LLaMA 3.3 70B</option>
<option value="meta-llama/llama-3.3-70b-coding:latest">LLaMA 3.3 Coding</option>
</select>
<input type="text" id="customModelName" placeholder="Custom Model Name (optional)">
<input type="text" id="customModelURL" placeholder="Custom Model Endpoint (optional)">
<div style="display:flex;gap:15px;margin-top:30px;">
<button onclick="closeModals()" style="flex:1;padding:15px;border-radius:12px;background:#222;border:none;color:white;cursor:pointer;">Cancel</button>
<button onclick="saveKey()" style="flex:1;padding:15px;border-radius:12px;background:var(--accent);border:none;color:black;font-weight:800;cursor:pointer;">Save Gateway</button>
</div>
</div>
</div>

<script>
lucide.createIcons();
let apiVault = JSON.parse(localStorage.getItem("omni_apex_vault")||"[]"), activeIdx = 0;

function autoSize(el){ el.style.height='auto'; el.style.height = el.scrollHeight+'px'; }

function handleAuth(){
    const email = document.getElementById("authEmail").value;
    if(!email) return alert("Enter workspace ID");
    localStorage.setItem("omni_session", email);
    document.getElementById("authScreen").style.display="none";
    document.getElementById("userName").innerText = email.split('@')[0].toUpperCase();
    renderVault();
}

document.getElementById("authBtn").addEventListener("click", handleAuth);

function openKeyModal(){ document.getElementById("keyModal").style.display="flex"; }
function closeModals(){ document.getElementById("keyModal").style.display="none"; }

function saveKey(){
    let modelValue = document.getElementById("modelSelect").value;
    const customName = document.getElementById("customModelName").value;
    const customURL = document.getElementById("customModelURL").value;
    if(customName && customURL){ modelValue = `${customName}|${customURL}`; }

    const key = {
        nick: document.getElementById("keyNick").value || "Main Gateway",
        val: document.getElementById("keyVal").value,
        model: modelValue
    };

    if(!key.val) return alert("API Key required");
    apiVault.unshift(key);
    localStorage.setItem("omni_apex_vault", JSON.stringify(apiVault));
    renderVault();
    closeModals();
}

function renderVault(){
    const list = document.getElementById("vaultList"); list.innerHTML="";
    apiVault.forEach((item,i)=>{
        const div = document.createElement("div");
        div.className=`key-card ${activeIdx==i?'active':''}`;
        div.innerHTML = `<div style="font-weight:800;font-size:0.8rem;">${item.nick}</div>
                         <div style="font-size:0.6rem;color:var(--text-dim)">
                         ${item.model.includes("|")?item.model.split("|")[0]:item.model.split("/")[1]}</div>`;
        div.onclick = ()=>{ activeIdx=i; renderVault(); };
        list.appendChild(div);
    });
    if(apiVault[activeIdx]){
        const modelName = apiVault[activeIdx].model.includes("|") 
            ? apiVault[activeIdx].model.split("|")[0] 
            : apiVault[activeIdx].model.split("/")[1];
        document.getElementById("activeModelName").innerText = modelName;
    }
}

function speak(text){ const utter = new SpeechSynthesisUtterance(text); utter.rate=1;utter.pitch=1; window.speechSynthesis.speak(utter); }

async function sendMessage(){
    const input = document.getElementById("msg"); const val = input.value;
    if(!val || !apiVault[activeIdx]) return alert("Select a Gateway Key first!");
    addBubble(val,'user'); input.value="";
    try{
        const res = await fetch("https://openrouter.ai/api/v1/chat/completions",{
            method:"POST",
            headers:{"Content-Type":"application/json","Authorization":`Bearer ${apiVault[activeIdx].val}`},
            body:JSON.stringify({model:apiVault[activeIdx].model,messages:[{role:"user",content:val}]})
        });
        const data = await res.json();
        const reply = data.choices[0].message.content;
        addBubble(reply,'bot');
    }catch(e){ addBubble("Connection lost.",'bot'); }
}

function addBubble(text,role){
    const chat = document.getElementById("chat");
    const div = document.createElement("div");
    div.className=`msg ${role}`;
    div.innerHTML=`<div class="bubble">${text} ${role==='bot'?`<button class="voice-btn" onclick="speak('${text.replace(/'/g,"\\'")}')"><i data-lucide="volume-2" size="12"></i> Listen</button>`:''}</div>`;
    chat.appendChild(div);
    chat.scrollTop = chat.scrollHeight;
    lucide.createIcons();
}

async function handleImageUpload(event){
    const file=event.target.files[0]; if(!file) return;
    const reader=new FileReader();
    reader.onload=async ()=>{
        const imgData=reader.result.split(',')[1];
        const res=await fetch("https://openrouter.ai/api/v1/images/generate",{
            method:"POST",
            headers:{"Content-Type":"application/json","Authorization":`Bearer ${apiVault[activeIdx].val}`},
            body:JSON.stringify({model:"stability/stable-diffusion-v1",prompt:"Create a professional avatar",image:imgData})
        });
        const data=await res.json();
        addBubble(`<img src='data:image/png;base64,${data.output[0]}' style='max-width:100%;border-radius:16px;'>`,'bot');
    };
    reader.readAsDataURL(file);
}

async function handleFileUpload(event){
    const file=event.target.files[0]; if(!file) return;
    const formData=new FormData(); formData.append('file',file);
    const res=await fetch("https://openrouter.ai/api/v1/files/analyze",{
        method:"POST", headers:{"Authorization":`Bearer ${apiVault[activeIdx].val}`}, body:formData
    });
    const data=await res.json();
    addBubble(`<strong>File Analysis:</strong><br>${data.summary}`,'bot');
}

function generateSocialPost(){
    const topic = prompt("Enter topic for social media post:"); if(!topic) return;
    sendMessage(`Create a professional social media post about: ${topic}`);
}

function generateDevCode(){
    const task = prompt("Describe the code/game feature you want:"); if(!task) return;
    sendMessage(`Write code for: ${task}`);
}

window.onload=()=>{
    if(localStorage.getItem("omni_session")){
        document.getElementById("authScreen").style.display="none";
        document.getElementById("userName").innerText = localStorage.getItem("omni_session").split('@')[0].toUpperCase();
        renderVault();
    }
};
</script>
</body>
</html>
